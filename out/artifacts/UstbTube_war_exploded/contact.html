<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="">
    <meta name="author" content="">
	
    <title>UstbTube</title>
	
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="rsc/css/bootstrap.min.css"  type="text/css">
	
	<!-- Custom CSS -->
    <link rel="stylesheet" href="rsc/css/style.css">
	
	<!-- Owl Carousel Assets -->
    <link href="rsc/owl-carousel/owl.carousel.css" rel="stylesheet">
    <link href="rsc/owl-carousel/owl.theme.css" rel="stylesheet">
	
	<!-- Custom Fonts -->
    <link rel="stylesheet" href="rsc/font-awesome-4.4.0/css/font-awesome.min.css"  type="text/css">
	<link rel="stylesheet" type="text/css" href="rsc/css/submit.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<link rel="stylesheet" type="text/css" href="rsc/css/normalize.css" />
	<link rel="stylesheet" type="text/css" href="rsc/css/demo.css" />
	<!--必要样式-->
	<link rel="stylesheet" type="text/css" href="rsc/css/component.css" />
	<!-- jQuery and Modernizr-->
	<script src="rsc/js/jquery-2.1.1.js"></script>
	
	<!-- Core JavaScript Files -->  	 
    <script src="rsc/js/bootstrap.min.js"></script>
	
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="rsc/js/html5shiv.js"></script>
        <script src="rsc/js/respond.min.js"></script>
    <![endif]-->

	<script src="rsc/js/user.js"></script>

</head>

<body>
	<header>
	<!--Top-->
	<nav id="top">
		<div class="container">
			<div class="row">
				<div class="col-md-6 col-sm-6">
					<strong id="welcome">Welcome to USTBTUBE!</strong>
				</div>
				<div class="col-md-6 col-sm-6">
					<ul class="list-inline top-link link">
						<li><a href="index.html"><i class="fa fa-home"></i> 主页</a></li>
						<li><a href="contact.html"><i class="fa fa-comments"></i> Contact</a></li>
						<li><a href="#"><i class="fa fa-question-circle"></i> FAQ</a></li>
					</ul>
				</div>
			</div>
		</div>
	</nav>
	
	<!--Navigation-->
    <nav id="menu" class="navbar">
		<div class="container">
			<div class="navbar-header"><span id="heading" class="visible-xs">Categories</span>
			  <button type="button" class="btn btn-navbar navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse"><i class="fa fa-bars"></i></button>
			</div>
			<div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li><a href="index"><i class="fa fa-home"></i> 主页</a></li>
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> 账号</a>
						<div class="dropdown-menu">
							<div class="dropdown-inner">
								<ul class="list-unstyled">
									<li id="log"><a href="log">登录/注册</a></li>
									<li id="mine"><a href="info">个人中心</a></li>
									<li id="favorites"><a href="favorites">收藏</a></li>
									<li id="history"><a href="log">历史</a></li>
									<li id="exit"><a href="log?state=exit">退出登录</a></li>
								</ul>
							</div>
						</div>
					</li>
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-play-circle-o"></i> 收藏</a>
						<div class="dropdown-menu">
							<div class="dropdown-inner">
								<ul class="list-unstyled">
									<li><a href="archive.html">Text 201</a></li>
									<li><a href="archive.html">Text 202</a></li>
									<li><a href="archive.html">Text 203</a></li>
									<li><a href="archive.html">Text 204</a></li>
									<li><a href="archive.html">Text 205</a></li>
								</ul>
							</div> 
						</div>
					</li>
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-list"></i> 分区</a>
						<div class="dropdown-menu" style="margin-left: -203.625px;">
							<div class="dropdown-inner">
								<ul class="list-unstyled">
									<li><a href="archive.html">自然</a></li>
									<li><a href="archive.html">生活</a></li>
									<li><a href="archive.html">科技</a></li>
								</ul>
								<ul class="list-unstyled">
									<li><a href="archive.html">游戏</a></li>
									<li><a href="archive.html">美食</a></li>
									<li><a href="archive.html">动画</a></li>
								</ul>
								<ul class="list-unstyled">
									<li><a href="archive.html">影视</a></li>
									<li><a href="archive.html">音乐</a></li>
									<li><a href="archive.html#">资讯</a></li>
								</ul>
							</div>
						</div>
					</li>
					<li id="submit"><a href="contact.html"><i class="fa fa-envelope"></i> 投稿</a></li>
				</ul>
			</div>
		</div>
	</nav>

</header>
<!-- Header -->
	
	<!-- /////////////////////////////////////////Content -->
	<div id="page-content" class="contact-page">
		<div class="container">
			<div class="row">
				<div id="main-content" class="col-md-8">
					<div class="box">
						<center><div class="art-header">
							<h1 class="center">视频上传</h1>
						</div></center>
						<div class="art-content">
							<div id="contact_form">
								<div id="ff"  >
									<label>
									<span>标题:</span>
									<input type="text"  name="name" id="title" required>
									</label>
									<label>
									<span>标签:</span>
									<input type="text"  name="email" id="tags" required>
									</label>
									<label>
									<span>简介:</span>
									<textarea name="message" id="description"></textarea>
									</label>
									<label>
										<span>选择视频 </span>
										<a class="list" href="javascript:;">
											<input id="file" type="file" name="myfile" onchange="UpladFile();" /><span>选择视频</span>
										</a>
										<span id="time"></span>
									</label>
									<label>
										<span>选择图片 </span>
										<!--文件选择按钮-->
										<a class="list" href="javascript:;">
											<input id="img" type="file" name="myimg" onchange="UpladImg();" /><span>选择图片</span>
										</a>
										<br>
										<br>
									</label>
									<!--显示消失-->
									<ul class="el-upload-list el-upload-list--text" style="display:  none;">
										<br>
										<li tabindex="0" class="el-upload-list__item is-success" >
											<a class="el-upload-list__item-name">
												<i class="el-icon-document"></i><span id="videoName">food.jpeg</span>
											</a>
											<label class="el-upload-list__item-status-label" >
												<i class="el-icon-upload-success el-icon-circle-check" ></i>
											</label>
											<i class="el-icon-close" onclick="del();"></i>
											<i class="el-icon-close-tip"></i>
										</li>
									</ul>

									<!--进度条-->
									<div class="el-progress el-progress--line" style="display: none;">
										<div class="el-progress-bar">
											<div class="el-progress-bar__outer" style="height: 6px;">
												<div class="el-progress-bar__inner" style="width: 0%;">
												</div>
											</div>
										</div>
										<div class="el-progress__text" style="font-size: 14.4px;">0%</div>
									</div>
<!--									<br>-->
<!--									<p class="_p black-box"><span>上传视频</span>：<button class="btn btn-primary" type="button" onclick="sub();">上传</button></p>-->

									<!--预览框-->
									<div class="preview">

									</div>


<!--									<center><input class="sendButton" type="submit" name="Submit" value="Submit" onclick="sub();"></center>-->
									<p class="_p black-box"><span>上传视频</span>：<button class="btn btn-primary" type="button" onclick="sub();">上传</button></p>

								</div>
							</div>
						</div>
					</div>
				</div>
				<div id="sidebar" class="col-md-4">
					<!---- Start Widget ---->
					<div class="widget wid-follow">
						<div class="heading"><h4><i class="fa fa-users"></i> Follow Us</h4></div>
						<div class="content">
							<img src="rsc/images/banner.jpg" />
						</div>
						<div class="line"></div>
					</div>
					<!---- Start Widget ---->
					<div class="widget wid-post">
						<div class="heading"><h4><i class="fa fa-globe"></i> Category</h4></div>
						<div class="content">
							<div class="post wrap-vid">
								<div class="zoom-container">
									<div class="zoom-caption">
										<span>Video's Tag</span>
										<a href="detail.html">
											<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
										</a>
										<p>Video's Name</p>
									</div>
									<img src="rsc/images/7.jpg" />
								</div>
								<div class="wrapper">
									<h5 class="vid-name"><a href="#">Video's Name</a></h5>
									<div class="info">
										<h6>By <a href="#">Kelvin</a></h6>
										<span><i class="fa fa-calendar"></i>25/3/2015</span> 
										<span><i class="fa fa-heart"></i>1,200</span>
									</div>
								</div>
							</div>
							<div class="post wrap-vid">
								<div class="zoom-container">
											<div class="zoom-caption">
												<span>Video's Tag</span>
												<a href="detail.html">
													<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
												</a>
												<p>Video's Name</p>
											</div>
											<img src="rsc/images/8.jpg" />
										</div>
								<div class="wrapper">
									<h5 class="vid-name"><a href="#">Video's Name</a></h5>
									<div class="info">
										<h6>By <a href="#">Kelvin</a></h6>
										<span><i class="fa fa-calendar"></i>25/3/2015</span> 
										<span><i class="fa fa-heart"></i>1,200</span>
									</div>
								</div>
							</div>
							<div class="post wrap-vid">
								<div class="zoom-container">
									<div class="zoom-caption">
										<span>Video's Tag</span>
										<a href="detail.html">
											<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
										</a>
										<p>Video's Name</p>
									</div>
									<img src="rsc/images/9.jpg" />
								</div>
								<div class="wrapper">
									<h5 class="vid-name"><a href="#">Video's Name</a></h5>
									<div class="info">
										<h6>By <a href="#">Kelvin</a></h6>
										<span><i class="fa fa-calendar"></i>25/3/2015</span> 
										<span><i class="fa fa-heart"></i>1,200</span>
									</div>
								</div>
							</div>
						</div>
						<div class="line"></div>
					</div>
					<!---- Start Widget ---->
					<div class="widget wid-news">
						<div class="heading"><h4><i class="fa fa-clock-o"></i> Top News</h4></div>
						<div class="content">
							<div class="wrap-vid">
								<div class="zoom-container">
									<div class="zoom-caption">
										<span>Video's Tag</span>
										<a href="detail.html">
											<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
										</a>
										<p>Video's Name</p>
									</div>
									<img src="rsc/images/3.jpg" />
								</div>
								<h3 class="vid-name"><a href="#">Video's Name</a></h3>
								<div class="info">
									<h5>By <a href="#">Kelvin</a></h5>
									<span><i class="fa fa-calendar"></i>25/3/2015</span> 
									<span><i class="fa fa-heart"></i>1,200</span>
								</div>
							</div>
							<div class="wrap-vid">
								<div class="zoom-container">
									<div class="zoom-caption">
										<span>Video's Tag</span>
										<a href="detail.html">
											<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
										</a>
										<p>Video's Name</p>
									</div>
									<img src="rsc/images/4.jpg" />
								</div>
								<h3 class="vid-name"><a href="#">Video's Name</a></h3>
								<div class="info">
									<h5>By <a href="#">Kelvin</a></h5>
									<span><i class="fa fa-calendar"></i>25/3/2015</span> 
									<span><i class="fa fa-heart"></i>1,200</span>
								</div>
							</div>
							<div class="wrap-vid">
								<div class="zoom-container">
									<div class="zoom-caption">
										<span>Video's Tag</span>
										<a href="detail.html">
											<i class="fa fa-play-circle-o fa-5x" style="color: #fff"></i>
										</a>
										<p>Video's Name</p>
									</div>
									<img src="rsc/images/5.jpg" />
								</div>
								<h3 class="vid-name"><a href="#">Video's Name</a></h3>
								<div class="info">
									<h5>By <a href="#">Kelvin</a></h5>
									<span><i class="fa fa-calendar"></i>25/3/2015</span> 
									<span><i class="fa fa-heart"></i>1,200</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<footer>
		<div class="top-footer">
			<ul class="footer-social list-inline">
				<li><a href="#"><i class="fa fa-twitter"></i> <span>Twitter</span></a></li>
				<li><a href="#"><i class="fa fa-facebook"></i> <span>Facebook</span></a></li>
				<li><a href="#"><i class="fa fa-google-plus"></i> <span>Google+</span></a></li>
				<li><a href="#"><i class="fa fa-youtube"></i> <span>Video's Tag</span></a></li>
				<li><a href="#"><i class="fa fa-vimeo-square"></i> <span>Vimeo</span></a></li>
				<li><a href="#"><i class="fa fa-pinterest"></i> <span>Pinterest</span></a></li>
				<li><a href="#"><i class="fa fa-rss"></i> <span>Rss</span></a></li>
			</ul>  
		</div>
		<div class="wrap-footer">
			<div class="container">
				<div class="row"> 
					<aside class="col-footer col-md-3">
						<h2 class="footer-title">About Us</h2>
						<div class="textwidget">Aenean feugiat in ante et blandit. Vestibulum posuere molestie risus, ac interdum magna porta non. Pellentesque rutrum fringilla elementum. Curabitur tincidunt porta lorem vitae accumsan. <br> <br> 
						Aenean feugiat in ante et blandit. Vestibulum posuere molestie risus, ac interdum magna porta non. Pellentesque rutrum fringilla elementum. Curabitur tincidunt porta lorem vitae accumsan.</div>
					</aside> 
					<aside class="col-footer col-md-3 widget_recent_entries">
						<h2 class="footer-title">Recent Posts</h2>
						<ul>
							<li><a href="#">MOST VISITED COUNTRIES</a></li>
							<li><a href="#">5 PLACES THAT MAKE A GREAT HOLIDAY</a></li>
							<li><a href="#">PEBBLE TIME STEEL IS ON TRACK TO SHIP IN JULY</a></li>
							<li><a href="#">STARTUP COMPANY&#8217;S CO-FOUNDER TALKS ON HIS NEW PRODUCT</a></li>
						</ul>
					</aside>
					<aside class="col-footer col-md-3">
						<h2 class="footer-title">NEWS LETTER</h2>
						If you want to receive our latest news send directly to your email, please leave your email address bellow. Subscription is free and you can cancel anytime.
						<form action="#" method="post">
							<input type="text" name="your-name" value="" size="40" placeholder="Your Email" />
							<input type="submit" value="SUBSCRIBE" class="btn btn-3" />
						</form>
					</aside>
					<aside class="col-footer col-md-3 wptt_TwitterTweets">
						<h2 class="footer-title">Twitter</h2>
						<ul class="fetched_tweets light">
							<li class="tweets_avatar">
								<div class="tweet_wrap">
									<div class="wdtf-user-card ltr">
										<div class="clear"></div>
									</div>
									<div class="tweet_data"> Check out 'NewsTube - Magazine Blog &amp; Video' on <a href="#" target="_blank" rel="nofollow">#EnvatoMarket</a> <a href="#" target="_blank" rel="nofollow">#themeforest</a> <a href="http://t.co/jQV1MrQQKY" target="_blank" rel="nofollow">http://t.co/jQV1MrQQKY</a></div> <br/>
									<div class="clear"></div>
									<div class="times"> <em> <a href="#" target="_blank" title="Follow cactusthemes on Twitter [Opens new window]"> 2 months ago </a> </em></div>
									<div class="clear"></div>
								</div>
								<div class="clear"></div>
							</li>
							<li class="tweets_avatar">
								<div class="tweet_wrap">
									<div class="wdtf-user-card ltr"><div class="clear"></div></div>
									<div class="tweet_data"> Our latest theme 'Nano - Simple Magazine WordPress Theme' on <a href="#" target="_blank" rel="nofollow">#EnvatoMarket</a> <a href="http://twitter.com/search?q=%23themeforest" target="_blank" rel="nofollow">#themeforest</a> <a href="http://t.co/IfZTbJTk06" target="_blank" rel="nofollow">http://t.co/IfZTbJTk06</a></div> <br/>
									<div class="clear"></div>
									<div class="times"> <em> <a href="#" target="_blank" title="Follow cactusthemes on Twitter [Opens new window]"> 5 months ago </a> </em></div>
									<div class="clear"></div>
								</div>
								<div class="clear"></div>
							</li>
						</ul>
					</aside>
				</div>
			</div>
		</div>
		<div class="bottom-footer">
			<div class="container">
				<div class="row">
					<div class="col-md-6 col-sm-6 copyright">
						<span>Copyright &copy; 2015.Company name All rights reserved.<a target="_blank" href="http://www.cssmoban.com/">&#x7F51;&#x9875;&#x6A21;&#x677F;</a></span>
					</div>
					<div class="col-md-6 col-sm-6 link">
						<div class="menu-footer-menu-container">
							<ul id="menu-footer-menu" class="menu list-inline">
								<li><a href="#"><i class="fa fa-home"></i> Home</a></li>
								<li><a href="#"><i class="fa fa-comments"></i> Contact</a></li>
								<li><a href="#"><i class="fa fa-question-circle"></i> FAQ</a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div> 
	</footer>
	<!-- Footer -->
	
	<!-- JS -->
	<script src="rsc/owl-carousel/owl.carousel.js"></script>
    <script>
    $(document).ready(function() {
      $("#owl-demo").owlCarousel({
        autoPlay: 3000,
        items : 5,
        itemsDesktop : [1199,4],
        itemsDesktopSmall : [979,4]
      });

    });
    </script>
	<script src="rsc/js/submit/TweenLite.min.js"></script>
	<script src="rsc/js/submit/EasePack.min.js"></script>
	<script src="rsc/js/submit/rAF.js"></script>
	<script src="rsc/js/submit/demo-1.js"></script>

	<script type="text/javascript">
		var xhr;//异步请求对象
		var ot; //时间
		var oloaded;//大小
		//上传文件方法
		function UpladFile() {
			var fileObj = document.getElementById("file").files[0]; // js 获取文件对象

			if(fileObj.name){
				$(".el-upload-list").css("display","block");
				$(".el-upload-list li").css("border","1px solid #20a0ff");
				$("#videoName").text(fileObj.name);
			}else{
				alert("请选择文件");
			}
		}
		function UpladImg() {
			var imgObj = document.getElementById("img").files[0]; // js 获取文件对象

			if(imgObj.name){
				$(".el-upload-list").css("display","block");
				$(".el-upload-list li").css("border","1px solid #20a0ff");
			}else{
				alert("请选择图片");
			}
		}
		/*点击取消*/
		function del(){
			$("#file").val('');
			$(".el-upload-list").css("display","none");
		}
		/*点击提交*/
		function sub() {
			var fileObj = document.getElementById("file").files[0]; // js 获取文件对象
			var imgObj = document.getElementById("img").files[0]; // js 获取文件对象

			if (fileObj == undefined || fileObj == "") {
				alert("请选择文件");
				return false;
			}
			if (imgObj == undefined || imgObj == "") {
				alert("请选择图片");
				return false;
			}

			var title = $.trim($("#title").val());
			// var username = $.trim($("#username").val());
			var tags = $.trim($("#tags").val());
			var description = $.trim($("#description").val());

			if (title == "") {
				alert("请填写视频标题");
				return false;
			}

			var url = "/UstbTube/submit"; // 接收上传文件的后台地址
			var form = new FormData(); // FormData 对象
			form.append("mf", fileObj); // 文件对象
			form.append("title", title); // 标题
			form.append("img", imgObj); // 图片对象
			// form.append("username", username); // 用户名
			form.append("tags", tags); // 标签
			form.append("description", description); // 简介

			var xhr = new XMLHttpRequest(); // XMLHttpRequest 对象
			xhr.open("POST", url, true); //post方式，url为服务器请求地址，true 该参数规定请求是否异步处理。

			// 请求完成的处理函数
			xhr.onload = uploadComplete; //请求完成
			xhr.onerror = uploadFailed; //请求失败

			// 上传进度的处理函数
			xhr.upload.onprogress = progressFunction; //【上传进度调用方法实现】
			xhr.upload.onloadstart = function() { //上传开始执行方法
				ot = new Date().getTime(); //设置上传开始时间
				oloaded = 0; //设置上传开始时，以上传的文件大小为0
			};
			xhr.send(form); //开始上传，发送form数据
		}

		//上传进度实现方法，上传过程中会频繁调用该方法
		function progressFunction(evt) {
			// event.total是需要传输的总字节，event.loaded是已经传输的字节。如果event.lengthComputable不为真，则event.total等于0
			if(evt.lengthComputable) {
				$(".el-progress--line").css("display","block");
				/*进度条显示进度*/
				$(".el-progress-bar__inner").css("width", Math.round(evt.loaded / evt.total * 100) + "%");
				$(".el-progress__text").html(Math.round(evt.loaded / evt.total * 100)+"%");
			}

			var time = document.getElementById("time");
			var nt = new Date().getTime(); //获取当前时间
			var pertime = (nt - ot) / 1000; //计算出上次调用该方法时到现在的时间差，单位为s
			ot = new Date().getTime(); //重新赋值时间，用于下次计算

			var perload = evt.loaded - oloaded; //计算该分段上传的文件大小，单位b
			oloaded = evt.loaded; //重新赋值已上传文件大小，用以下次计算

			//上传速度计算
			var speed = perload / pertime; //单位b/s
			var bspeed = speed;
			var units = 'b/s'; //单位名称
			if(speed / 1024 > 1) {
				speed = speed / 1024;
				units = 'k/s';
			}
			if(speed / 1024 > 1) {
				speed = speed / 1024;
				units = 'M/s';
			}
			speed = speed.toFixed(1);
			//剩余时间
			var resttime = ((evt.total - evt.loaded) / bspeed).toFixed(1);
			time.innerHTML = '上传速度：' + speed + units + ',剩余时间：' + resttime + 's';
			if(bspeed == 0)
				time.innerHTML = '上传已取消';
		}
		//上传成功响应
		function uploadComplete(evt) {
			//服务断接收完文件返回的结果  注意返回的字符串要去掉双引号
			if(evt.target.responseText){
				var str = "D:/Java/code/UstbTube/out/artifacts/UstbTube_war_explode/videos"+evt.target.responseText;
				alert("上传成功！");
				//$(".preview").append("<video  controls='' autoplay='' name='media'><source src="+str+" type='video/mp4'></video>");
			}else{
				alert("上传失败");
			}
		}
		//上传失败
		function uploadFailed(evt) {
			alert("上传失败！");
		}
	</script>
	
</body>
</html>
